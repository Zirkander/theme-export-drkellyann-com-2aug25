if(!customElements.get("custom-selectbutton")){class CustomSelectButton extends HTMLElement{constructor(){super()}close(){this.classList.remove("is-open")}handleSort(element){const filterSort=this.closest("[data-filter-sort]");filterSort&&filterSort.changeSortBy(element.dataset.value)}handleChange(element){this.current.innerHTML=element.innerHTML,this.hasAttribute("data-sort")&&this.handleSort(element),element.dataset.type=="url"&&this.closest("ajax-variant")?.update(element.dataset.value),this.querySelector(".is-active")?.classList.remove("is-active"),element.classList.add("is-active"),console.log("> custom-selectbutton: is active = ",element),this.close()}handleSellingPlansButtons(element){document.querySelector("#purchaseTypeSubscription")&&document.querySelector("#purchaseTypeSubscription").checked&&setTimeout(function(){document.querySelector("#purchaseTypeSubscription").click()},500)}handleSubscriptionOptions(element){const el=jQuery(element);if(el&&el.length){let idRef=el.attr("data-id"),delivery={1:"Delivered every 1 month",2:"Delivered every 3 month",3:"Delivered every 6 month"};jQuery(".buy-once-button").hide(),jQuery('.buy-once-button[data-id-ref="'+idRef+'"]').show(),jQuery(".rtx-subscription-dropdown").attr("data-auto-select-by-name",delivery[idRef]),jQuery(".rtx-subscription").length&&document.querySelector('.product__submit[type="submit"]').classList.add("loading"),setTimeout(function(){jQuery("#purchaseTypeSubscription").trigger("click")},550)}}handleOptionChange(element){console.log("handleOptionChange");const loopPurchaseOptionOneTime=document.querySelector(".loop-widget-purchase-option-onetime"),loopPurchaseOptions=document.querySelector(".loop-widget-purchase-option-selected .loop-widget-purchase-option-label");console.log(element),this.updateOOSSelect(element),this.handleChange(element),this.closest("product-form")?.update(element),setTimeout(()=>{loopPurchaseOptions.innerHTML=="One-time purchase"&&(console.log("loopPurchaseOptionssss---s",loopPurchaseOptions.innerHTML),loopPurchaseOptionOneTime.click())},5)}handleQuantityChange(element){this.handleChange(element),this.closest("product-form")?.updateQuantity(element.dataset.value)}updateCard(element){this.card=this.closest(".js-product-card"),this.card&&(this.updatePrice(element),this.card.querySelector("cart-add")?.update(element),this.updateImage(element))}updateOOSSelect(element){console.log("updateOOSSelect");let thisID=element.dataset.id,addToCartBtn=document.querySelector(".product__submit"),delayMessage=document.querySelector("div.delay"),rechargeWidget=document.querySelector(".rc-widget-injection-parent");if(thisID){let variantIventoryQty=document.querySelector('ul.inventory-available .span-wrap[data-index="'+thisID+'"]');variantIventoryQty&&variantIventoryQty.dataset.inventoryQty&&(variantIventoryQty.dataset.inventoryQty<=0?(console.log("variant inventory qty is 0 or less"),variantIventoryQty.dataset.value.toLowerCase()!=="continue"?(console.log("variant sold out and do no keep selling"),addToCartBtn.classList.add("d-none"),delayMessage.classList.remove("d-none"),rechargeWidget&&rechargeWidget.classList.add("d-none")):(console.log("variant sold out but keep selling"),document.getElementById("flavor_selector_type")&&document.getElementById("flavor_selector_type").value!=="Lemon Sips"&&(addToCartBtn.innerText="Add to Cart",addToCartBtn.classList.remove("d-none"),addToCartBtn.removeAttribute("disabled")),delayMessage?.classList.add("d-none"),rechargeWidget&&rechargeWidget.classList.remove("d-none"))):console.log("variant in stock keep selling"))}}updatePrice(element){this.price=this.card.querySelector(".js-price"),this.price.innerHTML=element.dataset.price}updateImage(element){let index=element.dataset;if(console.log("element ",element),index.value){console.log("element index.value ",index.value);let variantImgData=document.querySelector('ul.variant-images .span-wrap[data-value="'+index.value+'"]');console.log("variantImgData ",variantImgData),variantImgData&&variantImgData.dataset.variantImg&&document.querySelector(".product__media .swiper-slide-active img")&&(document.querySelector(".product__media .swiper-slide-active img").srcset=variantImgData.dataset.variantImg)}}connectedCallback(){this.current=this.querySelector(".js-current"),setTimeout(()=>{console.log("init variant image switch"),this.updateImage(this.current)},100),this.current&&(document.body.addEventListener("click",()=>{this.close()}),this.addEventListener("drag",event=>{event.stopPropagation()}),this.addEventListener("click",event=>{event.stopPropagation(),document.querySelectorAll("custom-selectbutton").forEach(element=>{element.classList.contains("is-open")&&element.close()});let targetElement=document.querySelector('.span-wrap[data-id="'+event.target.dataset.id+'"]');if(console.log("event.target.dataset.id ",event.target.dataset.id),console.log("targetElement ",targetElement),event.target.dataset.price&&this.updateCard(event.target),this.updateImage(event.target),this.dataset.type=="quantity"&&event.target.dataset.value)return this.handleQuantityChange(targetElement);if(event.target.dataset.index)return this.handleOptionChange(targetElement);if(event.target.dataset.variantId||event.target.dataset.value)return this.handleChange(targetElement)}))}}customElements.define("custom-selectbutton",CustomSelectButton)}
//# sourceMappingURL=/cdn/shop/t/229/assets/custom-selectbutton.js.map?v=55388308035824272111743805018
